{"ast":null,"code":"import _classCallCheck from\"/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{compose}from'react-recompose';import{withFirebase}from'../Firebase';import DashboardView from'./dashboardView';import{withAuthorization}from'../Session';import{jsx as _jsx}from\"react/jsx-runtime\";var Dashboard=/*#__PURE__*/function(_Component){_inherits(Dashboard,_Component);var _super=_createSuper(Dashboard);function Dashboard(props){var _this;_classCallCheck(this,Dashboard);_this=_super.call(this,props);_this.updateMenuDb=function(newMenu){// check that items are always arrays with items or 0\nif(newMenu.drinks.length===0)newMenu.drinks=0;if(newMenu.dishes.length===0)newMenu.dishes=0;// change second props with user uid in state\n_this.props.firebase.userMenu(_this.state.user.uid).set({drinks:newMenu.drinks,dishes:newMenu.dishes});};_this.updateTablesDb=function(newTables){if(newTables.length===0)newTables=0;_this.props.firebase.userTables(_this.state.user.uid).set(newTables);};_this.updateOrdersDb=function(newOrders){_this.props.firebase.userOrders(_this.state.user.uid).set(newOrders);};_this.createQR=function(tableNum){var takeOut=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var currentUrl=window.location.href;var qrUrl=currentUrl.split('').slice(0,currentUrl.length-9).join('');qrUrl=\"\".concat(qrUrl,\"menu/\").concat(_this.state.user.uid,\"/\").concat(takeOut?'takeout':tableNum);return\"https://api.qrserver.com/v1/create-qr-code/?data=\".concat(qrUrl,\"&amp;size=500x500\");};_this.toggleModal=function(){_this.setState({showModal:!_this.state.showModal});};_this.state={loading:false,user:{},menu:{},orders:{current:[],past:[]},showModal:false,isMobile:false};return _this;}_createClass(Dashboard,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.setState({loading:true});var userUid=this.props.firebase.getCurrentUserUid();var userIsAnonymous=this.props.firebase.getCurrentUser().isAnonymous?true:false;this.setState({loading:false,userIsAnonymous:userIsAnonymous,showModal:userIsAnonymous,isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)});this.props.firebase.user(userUid).on('value',function(snapshot){var userObject=snapshot.val();// check for demo user logout prevent crash\nif(_this2.props.firebase.getCurrentUser()===null||_this2.props.firebase.getCurrentUserUid()===null||userObject===null)return;userObject.uid=userUid;_this2.setState({user:userObject});});// fetch menu with user uid\nthis.props.firebase.userMenu(userUid).on('value',function(snapshot){_this2.setState({menu:snapshot.val()});});// fetch orders with user uid\nthis.props.firebase.userOrders(userUid).on('value',function(snapshot){var orders=snapshot.val();// check for demo user logout prevent crash\nif(orders===null)return;_this2.setState({orders:snapshot.val()});});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.props.firebase.users().off();}},{key:\"render\",value:function render(){var _this$state=this.state,loading=_this$state.loading,menu=_this$state.menu,orders=_this$state.orders,showModal=_this$state.showModal,isMobile=_this$state.isMobile;return/*#__PURE__*/_jsx(DashboardView,{menu:menu,orders:orders,loading:loading,isMobile:isMobile,showModal:showModal,createQR:this.createQR,toggleModal:this.toggleModal,tables:this.state.user.tables,updateMenuDb:this.updateMenuDb,updateOrdersDb:this.updateOrdersDb,updateTablesDb:this.updateTablesDb});}}]);return Dashboard;}(Component);var condition=function condition(authUser){return!!authUser;};export default compose(withAuthorization(condition),withFirebase)(Dashboard);","map":{"version":3,"names":["React","Component","compose","withFirebase","DashboardView","withAuthorization","jsx","_jsx","Dashboard","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","updateMenuDb","newMenu","drinks","length","dishes","firebase","userMenu","state","user","uid","set","updateTablesDb","newTables","userTables","updateOrdersDb","newOrders","userOrders","createQR","tableNum","takeOut","arguments","undefined","currentUrl","window","location","href","qrUrl","split","slice","join","concat","toggleModal","setState","showModal","loading","menu","orders","current","past","isMobile","_createClass","key","value","componentDidMount","_this2","userUid","getCurrentUserUid","userIsAnonymous","getCurrentUser","isAnonymous","test","navigator","userAgent","on","snapshot","userObject","val","componentWillUnmount","users","off","render","_this$state","tables","condition","authUser"],"sources":["/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/src/components/Dashboard/index.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { compose } from 'react-recompose';\n\nimport { withFirebase } from '../Firebase';\nimport DashboardView from './dashboardView';\nimport { withAuthorization } from '../Session';\n\nclass Dashboard extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      user: {},\n      menu: {},\n      orders: { current: [], past: [] },\n      showModal: false,\n      isMobile: false,\n    };\n  };\n\n  componentDidMount() {\n    this.setState({ loading: true });\n    let userUid = this.props.firebase.getCurrentUserUid();\n    let userIsAnonymous = this.props.firebase.getCurrentUser().isAnonymous ? true : false;\n    this.setState({\n      loading: false,\n      userIsAnonymous,\n      showModal: userIsAnonymous,\n      isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),\n    });\n\n    this.props.firebase.user(userUid).on('value', snapshot => {\n      const userObject = snapshot.val();\n      // check for demo user logout prevent crash\n      if(this.props.firebase.getCurrentUser() === null || this.props.firebase.getCurrentUserUid() === null || userObject === null) return;\n      userObject.uid = userUid;\n      this.setState({ user: userObject });\n    })\n\n    // fetch menu with user uid\n    this.props.firebase.userMenu(userUid).on('value', snapshot => {\n      this.setState({ menu: snapshot.val() });\n    });\n\n    // fetch orders with user uid\n    this.props.firebase.userOrders(userUid).on('value', snapshot => {\n      let orders = snapshot.val();\n      // check for demo user logout prevent crash\n      if(orders === null) return;\n      this.setState({ orders: snapshot.val() });\n    })\n  }\n\n  componentWillUnmount() {       \n    this.props.firebase.users().off();\n  }\n\n  updateMenuDb = (newMenu) => {\n    // check that items are always arrays with items or 0\n    if(newMenu.drinks.length === 0) newMenu.drinks = 0;\n    if(newMenu.dishes.length === 0) newMenu.dishes = 0;\n    // change second props with user uid in state\n    this.props.firebase.userMenu(this.state.user.uid).set({ \n      drinks: newMenu.drinks,\n      dishes: newMenu.dishes\n    });\n  }\n\n  updateTablesDb = (newTables) => {\n    if(newTables.length === 0) newTables = 0;\n    this.props.firebase.userTables(this.state.user.uid).set(newTables);\n  }\n\n  updateOrdersDb = (newOrders) => {\n    this.props.firebase.userOrders(this.state.user.uid).set(newOrders);\n  }\n\n  createQR = (tableNum, takeOut=false) => {\n    const currentUrl = window.location.href;\n    let qrUrl = currentUrl.split('').slice(0, currentUrl.length-9).join('');\n    qrUrl = `${qrUrl}menu/${this.state.user.uid}/${takeOut ? 'takeout' : tableNum}`;\n    return `https://api.qrserver.com/v1/create-qr-code/?data=${qrUrl}&amp;size=500x500`;\n  }\n\n  toggleModal = () => {\n    this.setState({\n      showModal: !this.state.showModal\n    });\n  };\n\n  render() {\n    const { loading, menu, orders, showModal, isMobile } = this.state;\n    return (\n      <DashboardView \n        menu={menu}\n        orders={orders}\n        loading={loading}\n        isMobile={isMobile}\n        showModal={showModal}\n        createQR={this.createQR}\n        toggleModal={this.toggleModal}\n        tables={this.state.user.tables}\n        updateMenuDb={this.updateMenuDb}\n        updateOrdersDb={this.updateOrdersDb}\n        updateTablesDb={this.updateTablesDb}\n      />\n    );\n  }\n}\n\nconst condition = authUser => !!authUser;\n\nexport default compose(\n  withAuthorization(condition),\n  withFirebase,\n)(Dashboard);\n"],"mappings":"4qBAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,OAASC,OAAO,KAAQ,iBAAiB,CAEzC,OAASC,YAAY,KAAQ,aAAa,CAC1C,MAAO,CAAAC,aAAa,KAAM,iBAAiB,CAC3C,OAASC,iBAAiB,KAAQ,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,4BAEzC,CAAAC,SAAS,uBAAAC,UAAA,EAAAC,SAAA,CAAAF,SAAA,CAAAC,UAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,SAAA,EACb,SAAAA,UAAYK,KAAK,CAAE,KAAAC,KAAA,CAAAC,eAAA,MAAAP,SAAA,EACjBM,KAAA,CAAAH,MAAA,CAAAK,IAAA,MAAMH,KAAK,EAAEC,KAAA,CAgDfG,YAAY,CAAG,SAACC,OAAO,CAAK,CAC1B;AACA,GAAGA,OAAO,CAACC,MAAM,CAACC,MAAM,GAAK,CAAC,CAAEF,OAAO,CAACC,MAAM,CAAG,CAAC,CAClD,GAAGD,OAAO,CAACG,MAAM,CAACD,MAAM,GAAK,CAAC,CAAEF,OAAO,CAACG,MAAM,CAAG,CAAC,CAClD;AACAP,KAAA,CAAKD,KAAK,CAACS,QAAQ,CAACC,QAAQ,CAACT,KAAA,CAAKU,KAAK,CAACC,IAAI,CAACC,GAAG,CAAC,CAACC,GAAG,CAAC,CACpDR,MAAM,CAAED,OAAO,CAACC,MAAM,CACtBE,MAAM,CAAEH,OAAO,CAACG,MAClB,CAAC,CAAC,CACJ,CAAC,CAAAP,KAAA,CAEDc,cAAc,CAAG,SAACC,SAAS,CAAK,CAC9B,GAAGA,SAAS,CAACT,MAAM,GAAK,CAAC,CAAES,SAAS,CAAG,CAAC,CACxCf,KAAA,CAAKD,KAAK,CAACS,QAAQ,CAACQ,UAAU,CAAChB,KAAA,CAAKU,KAAK,CAACC,IAAI,CAACC,GAAG,CAAC,CAACC,GAAG,CAACE,SAAS,CAAC,CACpE,CAAC,CAAAf,KAAA,CAEDiB,cAAc,CAAG,SAACC,SAAS,CAAK,CAC9BlB,KAAA,CAAKD,KAAK,CAACS,QAAQ,CAACW,UAAU,CAACnB,KAAA,CAAKU,KAAK,CAACC,IAAI,CAACC,GAAG,CAAC,CAACC,GAAG,CAACK,SAAS,CAAC,CACpE,CAAC,CAAAlB,KAAA,CAEDoB,QAAQ,CAAG,SAACC,QAAQ,CAAoB,IAAlB,CAAAC,OAAO,CAAAC,SAAA,CAAAjB,MAAA,IAAAiB,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAC,KAAK,CACjC,GAAM,CAAAE,UAAU,CAAGC,MAAM,CAACC,QAAQ,CAACC,IAAI,CACvC,GAAI,CAAAC,KAAK,CAAGJ,UAAU,CAACK,KAAK,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,CAAEN,UAAU,CAACnB,MAAM,CAAC,CAAC,CAAC,CAAC0B,IAAI,CAAC,EAAE,CAAC,CACvEH,KAAK,IAAAI,MAAA,CAAMJ,KAAK,UAAAI,MAAA,CAAQjC,KAAA,CAAKU,KAAK,CAACC,IAAI,CAACC,GAAG,MAAAqB,MAAA,CAAIX,OAAO,CAAG,SAAS,CAAGD,QAAQ,CAAE,CAC/E,0DAAAY,MAAA,CAA2DJ,KAAK,sBAClE,CAAC,CAAA7B,KAAA,CAEDkC,WAAW,CAAG,UAAM,CAClBlC,KAAA,CAAKmC,QAAQ,CAAC,CACZC,SAAS,CAAE,CAACpC,KAAA,CAAKU,KAAK,CAAC0B,SACzB,CAAC,CAAC,CACJ,CAAC,CA9ECpC,KAAA,CAAKU,KAAK,CAAG,CACX2B,OAAO,CAAE,KAAK,CACd1B,IAAI,CAAE,CAAC,CAAC,CACR2B,IAAI,CAAE,CAAC,CAAC,CACRC,MAAM,CAAE,CAAEC,OAAO,CAAE,EAAE,CAAEC,IAAI,CAAE,EAAG,CAAC,CACjCL,SAAS,CAAE,KAAK,CAChBM,QAAQ,CAAE,KACZ,CAAC,CAAC,OAAA1C,KAAA,CACJ,CAAC2C,YAAA,CAAAjD,SAAA,GAAAkD,GAAA,qBAAAC,KAAA,CAED,SAAAC,kBAAA,CAAoB,KAAAC,MAAA,MAClB,IAAI,CAACZ,QAAQ,CAAC,CAAEE,OAAO,CAAE,IAAK,CAAC,CAAC,CAChC,GAAI,CAAAW,OAAO,CAAG,IAAI,CAACjD,KAAK,CAACS,QAAQ,CAACyC,iBAAiB,EAAE,CACrD,GAAI,CAAAC,eAAe,CAAG,IAAI,CAACnD,KAAK,CAACS,QAAQ,CAAC2C,cAAc,EAAE,CAACC,WAAW,CAAG,IAAI,CAAG,KAAK,CACrF,IAAI,CAACjB,QAAQ,CAAC,CACZE,OAAO,CAAE,KAAK,CACda,eAAe,CAAfA,eAAe,CACfd,SAAS,CAAEc,eAAe,CAC1BR,QAAQ,CAAE,gEAAgE,CAACW,IAAI,CAACC,SAAS,CAACC,SAAS,CACrG,CAAC,CAAC,CAEF,IAAI,CAACxD,KAAK,CAACS,QAAQ,CAACG,IAAI,CAACqC,OAAO,CAAC,CAACQ,EAAE,CAAC,OAAO,CAAE,SAAAC,QAAQ,CAAI,CACxD,GAAM,CAAAC,UAAU,CAAGD,QAAQ,CAACE,GAAG,EAAE,CACjC;AACA,GAAGZ,MAAI,CAAChD,KAAK,CAACS,QAAQ,CAAC2C,cAAc,EAAE,GAAK,IAAI,EAAIJ,MAAI,CAAChD,KAAK,CAACS,QAAQ,CAACyC,iBAAiB,EAAE,GAAK,IAAI,EAAIS,UAAU,GAAK,IAAI,CAAE,OAC7HA,UAAU,CAAC9C,GAAG,CAAGoC,OAAO,CACxBD,MAAI,CAACZ,QAAQ,CAAC,CAAExB,IAAI,CAAE+C,UAAW,CAAC,CAAC,CACrC,CAAC,CAAC,CAEF;AACA,IAAI,CAAC3D,KAAK,CAACS,QAAQ,CAACC,QAAQ,CAACuC,OAAO,CAAC,CAACQ,EAAE,CAAC,OAAO,CAAE,SAAAC,QAAQ,CAAI,CAC5DV,MAAI,CAACZ,QAAQ,CAAC,CAAEG,IAAI,CAAEmB,QAAQ,CAACE,GAAG,EAAG,CAAC,CAAC,CACzC,CAAC,CAAC,CAEF;AACA,IAAI,CAAC5D,KAAK,CAACS,QAAQ,CAACW,UAAU,CAAC6B,OAAO,CAAC,CAACQ,EAAE,CAAC,OAAO,CAAE,SAAAC,QAAQ,CAAI,CAC9D,GAAI,CAAAlB,MAAM,CAAGkB,QAAQ,CAACE,GAAG,EAAE,CAC3B;AACA,GAAGpB,MAAM,GAAK,IAAI,CAAE,OACpBQ,MAAI,CAACZ,QAAQ,CAAC,CAAEI,MAAM,CAAEkB,QAAQ,CAACE,GAAG,EAAG,CAAC,CAAC,CAC3C,CAAC,CAAC,CACJ,CAAC,GAAAf,GAAA,wBAAAC,KAAA,CAED,SAAAe,qBAAA,CAAuB,CACrB,IAAI,CAAC7D,KAAK,CAACS,QAAQ,CAACqD,KAAK,EAAE,CAACC,GAAG,EAAE,CACnC,CAAC,GAAAlB,GAAA,UAAAC,KAAA,CAmCD,SAAAkB,OAAA,CAAS,CACP,IAAAC,WAAA,CAAuD,IAAI,CAACtD,KAAK,CAAzD2B,OAAO,CAAA2B,WAAA,CAAP3B,OAAO,CAAEC,IAAI,CAAA0B,WAAA,CAAJ1B,IAAI,CAAEC,MAAM,CAAAyB,WAAA,CAANzB,MAAM,CAAEH,SAAS,CAAA4B,WAAA,CAAT5B,SAAS,CAAEM,QAAQ,CAAAsB,WAAA,CAARtB,QAAQ,CAClD,mBACEjD,IAAA,CAACH,aAAa,EACZgD,IAAI,CAAEA,IAAK,CACXC,MAAM,CAAEA,MAAO,CACfF,OAAO,CAAEA,OAAQ,CACjBK,QAAQ,CAAEA,QAAS,CACnBN,SAAS,CAAEA,SAAU,CACrBhB,QAAQ,CAAE,IAAI,CAACA,QAAS,CACxBc,WAAW,CAAE,IAAI,CAACA,WAAY,CAC9B+B,MAAM,CAAE,IAAI,CAACvD,KAAK,CAACC,IAAI,CAACsD,MAAO,CAC/B9D,YAAY,CAAE,IAAI,CAACA,YAAa,CAChCc,cAAc,CAAE,IAAI,CAACA,cAAe,CACpCH,cAAc,CAAE,IAAI,CAACA,cAAe,EACpC,CAEN,CAAC,WAAApB,SAAA,GApGqBP,SAAS,EAuGjC,GAAM,CAAA+E,SAAS,CAAG,QAAZ,CAAAA,SAASA,CAAGC,QAAQ,QAAI,CAAC,CAACA,QAAQ,GAExC,cAAe,CAAA/E,OAAO,CACpBG,iBAAiB,CAAC2E,SAAS,CAAC,CAC5B7E,YAAY,CACb,CAACK,SAAS,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}