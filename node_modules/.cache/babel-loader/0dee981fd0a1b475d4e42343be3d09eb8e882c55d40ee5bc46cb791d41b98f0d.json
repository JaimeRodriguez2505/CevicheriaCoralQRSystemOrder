{"ast":null,"code":"import _regeneratorRuntime from\"/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useContext}from'react';import{Store}from'../../store';import{withFirebase}from'../Firebase';import*as ROUTES from'../../constants/routes';import{jsx as _jsx}from\"react/jsx-runtime\";var SignOutButton=function SignOutButton(_ref){var firebase=_ref.firebase,userIsAnonymous=_ref.userIsAnonymous,history=_ref.history;var _useContext=useContext(Store),dispatch=_useContext.dispatch;var toggleView=function toggleView(view){return dispatch({type:'TOGGLE_VIEW',payload:view});};var stopWatchingDbChanges=function stopWatchingDbChanges(){firebase.users().off();firebase.userOrders().off();firebase.userMenu().off();return Promise.resolve();};var deleteAnonDb=function deleteAnonDb(uid){firebase.user(uid).remove();firebase.userMenu(uid).remove();firebase.userOrders(uid).remove();return Promise.resolve();};var handleLogout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var anonUid;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:toggleView('orders');if(userIsAnonymous){anonUid=firebase.getCurrentUserUid();stopWatchingDbChanges().then(function(){deleteAnonDb(anonUid);}).then(function(){history.push(ROUTES.HOME);firebase.doSignOut();});}else{firebase.doSignOut();}case 2:case\"end\":return _context.stop();}},_callee);}));return function handleLogout(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return handleLogout();},children:\"SIGN OUT\"});};export default withFirebase(SignOutButton);","map":{"version":3,"names":["React","useContext","Store","withFirebase","ROUTES","jsx","_jsx","SignOutButton","_ref","firebase","userIsAnonymous","history","_useContext","dispatch","toggleView","view","type","payload","stopWatchingDbChanges","users","off","userOrders","userMenu","Promise","resolve","deleteAnonDb","uid","user","remove","handleLogout","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","anonUid","wrap","_callee$","_context","prev","next","getCurrentUserUid","then","push","HOME","doSignOut","stop","apply","arguments","onClick","children"],"sources":["/Users/soulkin/Documents/Cevicheria-Coral/Qr-Menu-Coral copy/CevicheriaCoralQRSystemOrder/src/components/SignOut/index.js"],"sourcesContent":["import React, { useContext } from 'react';\n\nimport { Store } from '../../store';\nimport { withFirebase } from '../Firebase';\nimport * as ROUTES from '../../constants/routes';\n\nconst SignOutButton = ({ firebase, userIsAnonymous, history }) => {\n  const { dispatch } = useContext(Store);\n  const toggleView = view => dispatch({ type: 'TOGGLE_VIEW', payload: view });\n\n  const stopWatchingDbChanges = () => {\n    firebase.users().off();\n    firebase.userOrders().off();\n    firebase.userMenu().off();\n    return Promise.resolve();\n  };\n\n  const deleteAnonDb = (uid) => {\n    firebase.user(uid).remove();\n    firebase.userMenu(uid).remove();\n    firebase.userOrders(uid).remove();\n    return Promise.resolve();\n  }\n\n  const handleLogout = async () => {\n    toggleView('orders');\n    if(userIsAnonymous) {\n      let anonUid = firebase.getCurrentUserUid();\n      stopWatchingDbChanges()\n        .then(() => {\n          deleteAnonDb(anonUid);\n        })\n        .then(() => {\n          history.push(ROUTES.HOME);\n          firebase.doSignOut();\n        });\n    } else {\n      firebase.doSignOut();\n    }\n  }\n\n  return (\n    <div onClick={() => handleLogout()}>\n      SIGN OUT\n    </div>\n  )\n};\n\nexport default withFirebase(SignOutButton);\n"],"mappings":"8WAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,KAAQ,OAAO,CAEzC,OAASC,KAAK,KAAQ,aAAa,CACnC,OAASC,YAAY,KAAQ,aAAa,CAC1C,MAAO,GAAK,CAAAC,MAAM,KAAM,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEjD,GAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAAC,IAAA,CAA+C,IAAzC,CAAAC,QAAQ,CAAAD,IAAA,CAARC,QAAQ,CAAEC,eAAe,CAAAF,IAAA,CAAfE,eAAe,CAAEC,OAAO,CAAAH,IAAA,CAAPG,OAAO,CACzD,IAAAC,WAAA,CAAqBX,UAAU,CAACC,KAAK,CAAC,CAA9BW,QAAQ,CAAAD,WAAA,CAARC,QAAQ,CAChB,GAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAGC,IAAI,QAAI,CAAAF,QAAQ,CAAC,CAAEG,IAAI,CAAE,aAAa,CAAEC,OAAO,CAAEF,IAAK,CAAC,CAAC,GAE3E,GAAM,CAAAG,qBAAqB,CAAG,QAAxB,CAAAA,qBAAqBA,CAAA,CAAS,CAClCT,QAAQ,CAACU,KAAK,EAAE,CAACC,GAAG,EAAE,CACtBX,QAAQ,CAACY,UAAU,EAAE,CAACD,GAAG,EAAE,CAC3BX,QAAQ,CAACa,QAAQ,EAAE,CAACF,GAAG,EAAE,CACzB,MAAO,CAAAG,OAAO,CAACC,OAAO,EAAE,CAC1B,CAAC,CAED,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAIC,GAAG,CAAK,CAC5BjB,QAAQ,CAACkB,IAAI,CAACD,GAAG,CAAC,CAACE,MAAM,EAAE,CAC3BnB,QAAQ,CAACa,QAAQ,CAACI,GAAG,CAAC,CAACE,MAAM,EAAE,CAC/BnB,QAAQ,CAACY,UAAU,CAACK,GAAG,CAAC,CAACE,MAAM,EAAE,CACjC,MAAO,CAAAL,OAAO,CAACC,OAAO,EAAE,CAC1B,CAAC,CAED,GAAM,CAAAK,YAAY,6BAAAC,KAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,OAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SACnB1B,UAAU,CAAC,QAAQ,CAAC,CACpB,GAAGJ,eAAe,CAAE,CACdyB,OAAO,CAAG1B,QAAQ,CAACgC,iBAAiB,EAAE,CAC1CvB,qBAAqB,EAAE,CACpBwB,IAAI,CAAC,UAAM,CACVjB,YAAY,CAACU,OAAO,CAAC,CACvB,CAAC,CAAC,CACDO,IAAI,CAAC,UAAM,CACV/B,OAAO,CAACgC,IAAI,CAACvC,MAAM,CAACwC,IAAI,CAAC,CACzBnC,QAAQ,CAACoC,SAAS,EAAE,CACtB,CAAC,CAAC,CACN,CAAC,IAAM,CACLpC,QAAQ,CAACoC,SAAS,EAAE,CACtB,CAAC,wBAAAP,QAAA,CAAAQ,IAAA,MAAAZ,OAAA,GACF,kBAfK,CAAAL,YAAYA,CAAA,SAAAC,KAAA,CAAAiB,KAAA,MAAAC,SAAA,OAejB,CAED,mBACE1C,IAAA,QAAK2C,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAApB,YAAY,EAAE,EAAC,CAAAqB,QAAA,CAAC,UAEpC,EAAM,CAEV,CAAC,CAED,cAAe,CAAA/C,YAAY,CAACI,aAAa,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}