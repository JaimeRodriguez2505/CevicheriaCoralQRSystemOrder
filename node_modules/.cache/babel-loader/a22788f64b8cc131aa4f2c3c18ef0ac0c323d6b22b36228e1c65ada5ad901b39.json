{"ast":null,"code":"import _regeneratorRuntime from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _jsxFileName = \"/Users/soulkin/Documents/dash-tabs-master/src/components/SignOut/index.js\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React, { useContext } from 'react';\nimport { Store } from '../../store';\nimport { withFirebase } from '../Firebase';\nimport * as ROUTES from '../../constants/routes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar SignOutButton = function SignOutButton(_ref) {\n  _s();\n  var firebase = _ref.firebase,\n    userIsAnonymous = _ref.userIsAnonymous,\n    history = _ref.history;\n  var _useContext = useContext(Store),\n    dispatch = _useContext.dispatch;\n  var toggleView = function toggleView(view) {\n    return dispatch({\n      type: 'TOGGLE_VIEW',\n      payload: view\n    });\n  };\n  var stopWatchingDbChanges = function stopWatchingDbChanges() {\n    firebase.users().off();\n    firebase.userOrders().off();\n    firebase.userMenu().off();\n    return Promise.resolve();\n  };\n  var deleteAnonDb = function deleteAnonDb(uid) {\n    firebase.user(uid).remove();\n    firebase.userMenu(uid).remove();\n    firebase.userOrders(uid).remove();\n    return Promise.resolve();\n  };\n  var handleLogout = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var anonUid;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            toggleView('orders');\n            if (userIsAnonymous) {\n              anonUid = firebase.getCurrentUserUid();\n              stopWatchingDbChanges().then(function () {\n                deleteAnonDb(anonUid);\n              }).then(function () {\n                history.push(ROUTES.HOME);\n                firebase.doSignOut();\n              });\n            } else {\n              firebase.doSignOut();\n            }\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    return function handleLogout() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    onClick: function onClick() {\n      return handleLogout();\n    },\n    children: \"SIGN OUT\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, _this);\n};\n_s(SignOutButton, \"y0TpHjmA0G5gpKtNPtwKueTIMNE=\");\n_c = SignOutButton;\nexport default _c2 = withFirebase(SignOutButton);\nvar _c, _c2;\n$RefreshReg$(_c, \"SignOutButton\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","useContext","Store","withFirebase","ROUTES","jsxDEV","_jsxDEV","SignOutButton","_ref","_s","firebase","userIsAnonymous","history","_useContext","dispatch","toggleView","view","type","payload","stopWatchingDbChanges","users","off","userOrders","userMenu","Promise","resolve","deleteAnonDb","uid","user","remove","handleLogout","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","anonUid","wrap","_callee$","_context","prev","next","getCurrentUserUid","then","push","HOME","doSignOut","stop","apply","arguments","onClick","children","fileName","_jsxFileName","lineNumber","columnNumber","_this","_c","_c2","$RefreshReg$"],"sources":["/Users/soulkin/Documents/dash-tabs-master/src/components/SignOut/index.js"],"sourcesContent":["import React, { useContext } from 'react';\n\nimport { Store } from '../../store';\nimport { withFirebase } from '../Firebase';\nimport * as ROUTES from '../../constants/routes';\n\nconst SignOutButton = ({ firebase, userIsAnonymous, history }) => {\n  const { dispatch } = useContext(Store);\n  const toggleView = view => dispatch({ type: 'TOGGLE_VIEW', payload: view });\n\n  const stopWatchingDbChanges = () => {\n    firebase.users().off();\n    firebase.userOrders().off();\n    firebase.userMenu().off();\n    return Promise.resolve();\n  };\n\n  const deleteAnonDb = (uid) => {\n    firebase.user(uid).remove();\n    firebase.userMenu(uid).remove();\n    firebase.userOrders(uid).remove();\n    return Promise.resolve();\n  }\n\n  const handleLogout = async () => {\n    toggleView('orders');\n    if(userIsAnonymous) {\n      let anonUid = firebase.getCurrentUserUid();\n      stopWatchingDbChanges()\n        .then(() => {\n          deleteAnonDb(anonUid);\n        })\n        .then(() => {\n          history.push(ROUTES.HOME);\n          firebase.doSignOut();\n        });\n    } else {\n      firebase.doSignOut();\n    }\n  }\n\n  return (\n    <div onClick={() => handleLogout()}>\n      SIGN OUT\n    </div>\n  )\n};\n\nexport default withFirebase(SignOutButton);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}