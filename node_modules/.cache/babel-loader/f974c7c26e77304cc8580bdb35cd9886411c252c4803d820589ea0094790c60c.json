{"ast":null,"code":"import _objectSpread from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _createClass from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\n// Import the functions you need from the SDKs you need\nimport firebase from 'firebase/compat/app';\nimport 'firebase/compat/auth';\nimport 'firebase/compat/database';\n\n// Configuración de Firebase utilizando variables de entorno\nvar config = {\n  apiKey: process.env.REACT_APP_FIREBASE_KEY,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\n  authDomain: process.env.REACT_APP_FIREBASE_DOMAIN,\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_SENDER_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET\n};\nvar Firebase = /*#__PURE__*/_createClass(function Firebase() {\n  var _this = this;\n  _classCallCheck(this, Firebase);\n  // Auth API\n  this.doCreateUserWithEmailAndPassword = function (email, password) {\n    return _this.auth.createUserWithEmailAndPassword(email, password);\n  };\n  this.doSignInWithEmailAndPassword = function (email, password) {\n    return _this.auth.signInWithEmailAndPassword(email, password);\n  };\n  this.doSignOut = function () {\n    return _this.auth.signOut();\n  };\n  this.doPasswordReset = function (email) {\n    return _this.auth.sendPasswordResetEmail(email);\n  };\n  this.doPasswordUpdate = function (password) {\n    return _this.auth.currentUser.updatePassword(password);\n  };\n  // Merge Auth and DB User API\n  this.onAuthUserListener = function (next, fallback) {\n    return _this.auth.onAuthStateChanged(function (authUser) {\n      if (authUser) {\n        _this.user(authUser.uid).once('value').then(function (snapshot) {\n          var dbUser = snapshot.val();\n          // merge auth and db user\n          authUser = _objectSpread({\n            uid: authUser.uid,\n            email: authUser.email,\n            isAnonymous: authUser.isAnonymous\n          }, dbUser);\n          next(authUser);\n        });\n      } else {\n        fallback();\n      }\n    });\n  };\n  this.doSignInAnonymously = function () {\n    return _this.auth.signInAnonymously();\n  };\n  // Cleanup Orders\n  this.cleanupDemoOrders = function (time) {\n    var keysToDelete = [];\n    _this.db.ref(\"orders/\").once('value').then(function (snapshot) {\n      var orders = snapshot.val();\n      for (var key in orders) {\n        if (orders[key].hasOwnProperty('timestamp')) {\n          if (time - orders[key][\"timestamp\"] > 900000) {\n            keysToDelete.push(key);\n          }\n        }\n      }\n      ;\n    }).then(function () {\n      for (var i = 0; i < keysToDelete.length; i++) {\n        _this.userOrders(keysToDelete[i]).remove();\n      }\n      ;\n    });\n  };\n  // Cleanup Menu\n  this.cleanupDemoMenus = function (time) {\n    var keysToDelete = [];\n    _this.db.ref(\"menus/\").once('value').then(function (snapshot) {\n      var menus = snapshot.val();\n      for (var key in menus) {\n        if (menus[key].hasOwnProperty('timestamp')) {\n          if (time - menus[key][\"timestamp\"] > 900000) {\n            keysToDelete.push(key);\n          }\n        }\n      }\n      ;\n    }).then(function () {\n      for (var i = 0; i < keysToDelete.length; i++) {\n        _this.userMenu(keysToDelete[i]).remove();\n      }\n      ;\n    });\n  };\n  // Cleanup Users\n  this.cleanupDemoUsers = function (time) {\n    var keysToDelete = [];\n    _this.db.ref(\"users/\").once('value').then(function (snapshot) {\n      var users = snapshot.val();\n      for (var key in users) {\n        if (users[key].hasOwnProperty('timestamp')) {\n          if (time - users[key][\"timestamp\"] > 900000) {\n            keysToDelete.push(key);\n          }\n        }\n      }\n      ;\n    }).then(function () {\n      for (var i = 0; i < keysToDelete.length; i++) {\n        _this.user(keysToDelete[i]).remove();\n      }\n      ;\n    });\n  };\n  this.demoCleanupDb = function () {\n    var currentTime = new Date().getTime();\n    _this.cleanupDemoOrders(currentTime);\n    _this.cleanupDemoMenus(currentTime);\n    _this.cleanupDemoUsers(currentTime);\n  };\n  this.getCurrentUserUid = function () {\n    return _this.auth.currentUser.uid;\n  };\n  this.getCurrentUser = function () {\n    return _this.auth.currentUser;\n  };\n  // User API\n  this.users = function () {\n    return _this.db.ref('users');\n  };\n  this.user = function (uid) {\n    return _this.db.ref(\"users/\".concat(uid));\n  };\n  this.userMenu = function (uid) {\n    return _this.db.ref(\"menus/\".concat(uid));\n  };\n  this.userOrders = function (uid) {\n    return _this.db.ref(\"orders/\".concat(uid));\n  };\n  this.userTables = function (uid) {\n    return _this.db.ref(\"users/\".concat(uid, \"/tables\"));\n  };\n  this.userBusinessName = function (uid) {\n    return _this.db.ref(\"users/\".concat(uid, \"/businessName\"));\n  };\n  if (!firebase.apps.length) {\n    firebase.initializeApp(config);\n  }\n  this.auth = firebase.auth();\n  this.db = firebase.database();\n});\nexport default Firebase;","map":{"version":3,"names":["firebase","config","apiKey","process","env","REACT_APP_FIREBASE_KEY","appId","REACT_APP_FIREBASE_APP_ID","authDomain","REACT_APP_FIREBASE_DOMAIN","databaseURL","REACT_APP_FIREBASE_DATABASE","projectId","REACT_APP_FIREBASE_PROJECT_ID","messagingSenderId","REACT_APP_FIREBASE_SENDER_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","Firebase","_createClass","_this","_classCallCheck","doCreateUserWithEmailAndPassword","email","password","auth","createUserWithEmailAndPassword","doSignInWithEmailAndPassword","signInWithEmailAndPassword","doSignOut","signOut","doPasswordReset","sendPasswordResetEmail","doPasswordUpdate","currentUser","updatePassword","onAuthUserListener","next","fallback","onAuthStateChanged","authUser","user","uid","once","then","snapshot","dbUser","val","_objectSpread","isAnonymous","doSignInAnonymously","signInAnonymously","cleanupDemoOrders","time","keysToDelete","db","ref","orders","key","hasOwnProperty","push","i","length","userOrders","remove","cleanupDemoMenus","menus","userMenu","cleanupDemoUsers","users","demoCleanupDb","currentTime","Date","getTime","getCurrentUserUid","getCurrentUser","concat","userTables","userBusinessName","apps","initializeApp","database"],"sources":["/Users/soulkin/Documents/dash-tabs-master/src/components/Firebase/firebase.js"],"sourcesContent":["// Import the functions you need from the SDKs you need\nimport firebase from 'firebase/compat/app';\nimport 'firebase/compat/auth';\nimport 'firebase/compat/database';\n\n// Configuración de Firebase utilizando variables de entorno\nconst config = {\n  apiKey: process.env.REACT_APP_FIREBASE_KEY,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\n  authDomain: process.env.REACT_APP_FIREBASE_DOMAIN,\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_SENDER_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n};\n\nclass Firebase {\n  constructor() {\n    if (!firebase.apps.length) {\n      firebase.initializeApp(config);\n    }\n    this.auth = firebase.auth();\n    this.db = firebase.database();\n  }\n\n  // Auth API\n  doCreateUserWithEmailAndPassword = (email, password) =>\n    this.auth.createUserWithEmailAndPassword(email, password);\n\n  doSignInWithEmailAndPassword = (email, password) =>\n    this.auth.signInWithEmailAndPassword(email, password);\n\n  doSignOut = () => this.auth.signOut();\n\n  doPasswordReset = email => this.auth.sendPasswordResetEmail(email);\n\n  doPasswordUpdate = password =>\n    this.auth.currentUser.updatePassword(password);\n\n  // Merge Auth and DB User API\n  onAuthUserListener = (next, fallback) =>\n    this.auth.onAuthStateChanged(authUser => {\n      if (authUser) {\n        this.user(authUser.uid)\n          .once('value')\n          .then(snapshot => {\n            const dbUser = snapshot.val();\n            // merge auth and db user\n            authUser = {\n              uid: authUser.uid,\n              email: authUser.email,\n              isAnonymous: authUser.isAnonymous,\n              ...dbUser,\n            };\n            next(authUser);\n          });\n      } else {\n        fallback();\n      }\n    });\n\n  doSignInAnonymously = () =>\n    this.auth.signInAnonymously();\n\n  // Cleanup Orders\n  cleanupDemoOrders = (time) => {\n    let keysToDelete = [];\n    this.db.ref(`orders/`).once('value').then(snapshot => { \n      let orders = snapshot.val(); \n      for(var key in orders) {\n        if(orders[key].hasOwnProperty('timestamp')) {\n          if(time - orders[key][\"timestamp\"] > 900000) { \n            keysToDelete.push(key); \n          }\n        }\n      };\n    }).then(() => {\n      for(let i=0; i<keysToDelete.length; i++) { \n        this.userOrders(keysToDelete[i]).remove();\n      };\n    });\n  }\n\n  // Cleanup Menu\n  cleanupDemoMenus = (time) => {\n    let keysToDelete = [];\n    this.db.ref(`menus/`).once('value').then(snapshot => { \n      let menus = snapshot.val(); \n      for(var key in menus) {\n        if(menus[key].hasOwnProperty('timestamp')) {\n          if(time - menus[key][\"timestamp\"] > 900000) { \n            keysToDelete.push(key); \n          }\n        }\n      };\n    }).then(() => {\n      for(let i=0; i<keysToDelete.length; i++) { \n        this.userMenu(keysToDelete[i]).remove();\n      };\n    });\n  }\n\n  // Cleanup Users\n  cleanupDemoUsers = (time) => {\n    let keysToDelete = [];\n    this.db.ref(`users/`).once('value').then(snapshot => { \n      let users = snapshot.val(); \n      for(var key in users) {\n        if(users[key].hasOwnProperty('timestamp')) {\n          if(time - users[key][\"timestamp\"] > 900000) { \n            keysToDelete.push(key); \n          }\n        }\n      };\n    }).then(() => {\n      for(let i=0; i<keysToDelete.length; i++) { \n        this.user(keysToDelete[i]).remove();\n      };\n    });\n  }\n\n  demoCleanupDb = () => {\n    let currentTime = new Date().getTime();\n    this.cleanupDemoOrders(currentTime);  \n    this.cleanupDemoMenus(currentTime);  \n    this.cleanupDemoUsers(currentTime);\n  };\n\n  getCurrentUserUid = () => this.auth.currentUser.uid;\n  getCurrentUser = () => this.auth.currentUser;\n\n  // User API\n  users = () => this.db.ref('users');\n  user = uid => this.db.ref(`users/${uid}`);\n  userMenu = uid => this.db.ref(`menus/${uid}`);\n  userOrders = uid => this.db.ref(`orders/${uid}`);\n  userTables = uid => this.db.ref(`users/${uid}/tables`);\n  userBusinessName = uid => this.db.ref(`users/${uid}/businessName`);\n}\n\nexport default Firebase;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}