{"ast":null,"code":"import _classCallCheck from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/soulkin/Documents/dash-tabs-master/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nvar _jsxFileName = \"/Users/soulkin/Documents/dash-tabs-master/src/components/Dashboard/index.js\";\nimport React, { Component } from 'react';\nimport { compose } from 'react-recompose';\nimport { withFirebase } from '../Firebase';\nimport DashboardView from './dashboardView';\nimport { withAuthorization } from '../Session';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar Dashboard = /*#__PURE__*/function (_Component) {\n  _inherits(Dashboard, _Component);\n  var _super = _createSuper(Dashboard);\n  function Dashboard(props) {\n    var _this;\n    _classCallCheck(this, Dashboard);\n    _this = _super.call(this, props);\n    _this.updateMenuDb = function (newMenu) {\n      // check that items are always arrays with items or 0\n      if (newMenu.drinks.length === 0) newMenu.drinks = 0;\n      if (newMenu.dishes.length === 0) newMenu.dishes = 0;\n      // change second props with user uid in state\n      _this.props.firebase.userMenu(_this.state.user.uid).set({\n        drinks: newMenu.drinks,\n        dishes: newMenu.dishes\n      });\n    };\n    _this.updateTablesDb = function (newTables) {\n      if (newTables.length === 0) newTables = 0;\n      _this.props.firebase.userTables(_this.state.user.uid).set(newTables);\n    };\n    _this.updateOrdersDb = function (newOrders) {\n      _this.props.firebase.userOrders(_this.state.user.uid).set(newOrders);\n    };\n    _this.createQR = function (tableNum) {\n      var takeOut = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var currentUrl = window.location.href;\n      var qrUrl = currentUrl.split('').slice(0, currentUrl.length - 9).join('');\n      qrUrl = \"\".concat(qrUrl, \"menu/\").concat(_this.state.user.uid, \"/\").concat(takeOut ? 'takeout' : tableNum);\n      return \"https://api.qrserver.com/v1/create-qr-code/?data=\".concat(qrUrl, \"&amp;size=500x500\");\n    };\n    _this.toggleModal = function () {\n      _this.setState({\n        showModal: !_this.state.showModal\n      });\n    };\n    _this.state = {\n      loading: false,\n      user: {},\n      menu: {},\n      orders: {\n        current: [],\n        past: []\n      },\n      showModal: false,\n      isMobile: false\n    };\n    return _this;\n  }\n  _createClass(Dashboard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      this.setState({\n        loading: true\n      });\n      var userUid = this.props.firebase.getCurrentUserUid();\n      var userIsAnonymous = this.props.firebase.getCurrentUser().isAnonymous ? true : false;\n      this.setState({\n        loading: false,\n        userIsAnonymous: userIsAnonymous,\n        showModal: userIsAnonymous,\n        isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)\n      });\n      this.props.firebase.user(userUid).on('value', function (snapshot) {\n        var userObject = snapshot.val();\n        // check for demo user logout prevent crash\n        if (_this2.props.firebase.getCurrentUser() === null || _this2.props.firebase.getCurrentUserUid() === null || userObject === null) return;\n        userObject.uid = userUid;\n        _this2.setState({\n          user: userObject\n        });\n      });\n\n      // fetch menu with user uid\n      this.props.firebase.userMenu(userUid).on('value', function (snapshot) {\n        _this2.setState({\n          menu: snapshot.val()\n        });\n      });\n\n      // fetch orders with user uid\n      this.props.firebase.userOrders(userUid).on('value', function (snapshot) {\n        var orders = snapshot.val();\n        // check for demo user logout prevent crash\n        if (orders === null) return;\n        _this2.setState({\n          orders: snapshot.val()\n        });\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.firebase.users().off();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n        loading = _this$state.loading,\n        menu = _this$state.menu,\n        orders = _this$state.orders,\n        showModal = _this$state.showModal,\n        isMobile = _this$state.isMobile;\n      return /*#__PURE__*/_jsxDEV(DashboardView, {\n        menu: menu,\n        orders: orders,\n        loading: loading,\n        isMobile: isMobile,\n        showModal: showModal,\n        createQR: this.createQR,\n        toggleModal: this.toggleModal,\n        tables: this.state.user.tables,\n        updateMenuDb: this.updateMenuDb,\n        updateOrdersDb: this.updateOrdersDb,\n        updateTablesDb: this.updateTablesDb\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n  return Dashboard;\n}(Component);\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\nexport default compose(withAuthorization(condition), withFirebase)(Dashboard);","map":{"version":3,"names":["React","Component","compose","withFirebase","DashboardView","withAuthorization","jsxDEV","_jsxDEV","Dashboard","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","updateMenuDb","newMenu","drinks","length","dishes","firebase","userMenu","state","user","uid","set","updateTablesDb","newTables","userTables","updateOrdersDb","newOrders","userOrders","createQR","tableNum","takeOut","arguments","undefined","currentUrl","window","location","href","qrUrl","split","slice","join","concat","toggleModal","setState","showModal","loading","menu","orders","current","past","isMobile","_createClass","key","value","componentDidMount","_this2","userUid","getCurrentUserUid","userIsAnonymous","getCurrentUser","isAnonymous","test","navigator","userAgent","on","snapshot","userObject","val","componentWillUnmount","users","off","render","_this$state","tables","fileName","_jsxFileName","lineNumber","columnNumber","condition","authUser"],"sources":["/Users/soulkin/Documents/dash-tabs-master/src/components/Dashboard/index.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { compose } from 'react-recompose';\n\nimport { withFirebase } from '../Firebase';\nimport DashboardView from './dashboardView';\nimport { withAuthorization } from '../Session';\n\nclass Dashboard extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      user: {},\n      menu: {},\n      orders: { current: [], past: [] },\n      showModal: false,\n      isMobile: false,\n    };\n  };\n\n  componentDidMount() {\n    this.setState({ loading: true });\n    let userUid = this.props.firebase.getCurrentUserUid();\n    let userIsAnonymous = this.props.firebase.getCurrentUser().isAnonymous ? true : false;\n    this.setState({\n      loading: false,\n      userIsAnonymous,\n      showModal: userIsAnonymous,\n      isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),\n    });\n\n    this.props.firebase.user(userUid).on('value', snapshot => {\n      const userObject = snapshot.val();\n      // check for demo user logout prevent crash\n      if(this.props.firebase.getCurrentUser() === null || this.props.firebase.getCurrentUserUid() === null || userObject === null) return;\n      userObject.uid = userUid;\n      this.setState({ user: userObject });\n    })\n\n    // fetch menu with user uid\n    this.props.firebase.userMenu(userUid).on('value', snapshot => {\n      this.setState({ menu: snapshot.val() });\n    });\n\n    // fetch orders with user uid\n    this.props.firebase.userOrders(userUid).on('value', snapshot => {\n      let orders = snapshot.val();\n      // check for demo user logout prevent crash\n      if(orders === null) return;\n      this.setState({ orders: snapshot.val() });\n    })\n  }\n\n  componentWillUnmount() {       \n    this.props.firebase.users().off();\n  }\n\n  updateMenuDb = (newMenu) => {\n    // check that items are always arrays with items or 0\n    if(newMenu.drinks.length === 0) newMenu.drinks = 0;\n    if(newMenu.dishes.length === 0) newMenu.dishes = 0;\n    // change second props with user uid in state\n    this.props.firebase.userMenu(this.state.user.uid).set({ \n      drinks: newMenu.drinks,\n      dishes: newMenu.dishes\n    });\n  }\n\n  updateTablesDb = (newTables) => {\n    if(newTables.length === 0) newTables = 0;\n    this.props.firebase.userTables(this.state.user.uid).set(newTables);\n  }\n\n  updateOrdersDb = (newOrders) => {\n    this.props.firebase.userOrders(this.state.user.uid).set(newOrders);\n  }\n\n  createQR = (tableNum, takeOut=false) => {\n    const currentUrl = window.location.href;\n    let qrUrl = currentUrl.split('').slice(0, currentUrl.length-9).join('');\n    qrUrl = `${qrUrl}menu/${this.state.user.uid}/${takeOut ? 'takeout' : tableNum}`;\n    return `https://api.qrserver.com/v1/create-qr-code/?data=${qrUrl}&amp;size=500x500`;\n  }\n\n  toggleModal = () => {\n    this.setState({\n      showModal: !this.state.showModal\n    });\n  };\n\n  render() {\n    const { loading, menu, orders, showModal, isMobile } = this.state;\n    return (\n      <DashboardView \n        menu={menu}\n        orders={orders}\n        loading={loading}\n        isMobile={isMobile}\n        showModal={showModal}\n        createQR={this.createQR}\n        toggleModal={this.toggleModal}\n        tables={this.state.user.tables}\n        updateMenuDb={this.updateMenuDb}\n        updateOrdersDb={this.updateOrdersDb}\n        updateTablesDb={this.updateTablesDb}\n      />\n    );\n  }\n}\n\nconst condition = authUser => !!authUser;\n\nexport default compose(\n  withAuthorization(condition),\n  withFirebase,\n)(Dashboard);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}